--Use BGoodMusicDev;
--USE MVCDemo;
GO

Declare @Use_MigrationHistory bit; Select @Use_MigrationHistory = 0;
--Declare @Use_MigrationHistory bit; Select @Use_MigrationHistory = 1;

Print 'Use_MigrationHistory = ' + ISNULL(Convert(varchar,@Use_MigrationHistory),'??');
DECLARE @CurrentMigration [nvarchar](max);

IF ISNULL(@Use_MigrationHistory,0) = 1 Begin

	Print '';
IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'BGoodMusic.EFDAL.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

End;

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

Print 'CurrentMigration = ' + ISNULL(@CurrentMigration,'??');

IF @CurrentMigration < '201410241610511_Schema1'
BEGIN
    CREATE TABLE [dbo].[bgm_Rehearsals] (
        [Id] [int] NOT NULL IDENTITY,
        [Date] [datetime] NOT NULL,
        [Time] [time](7) NOT NULL,
        [Duration] [time](7),
        [Location] [nvarchar](512),
        [Agenda] [nvarchar](2048) NOT NULL,
        CONSTRAINT [PK_dbo.bgm_Rehearsals] PRIMARY KEY ([Id])
    )

	--******

End;

IF ISNULL(@Use_MigrationHistory,0) = 1 Begin

    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201410241610511_Schema1', N'BGoodMusic.EFDAL.Migrations.Configuration',  0x1F8B0800000000000400CD58CD6EDB3810BE2FB0EF20E89C4AB69362DB406EE1D871116C9C0451DA6B414B639B588AD49254603FDB1EF691F6157668EA5FB6E2A4C5626F1235F3CD7038F3F1B3FFF9EBEFE0F33661CE334845051FBB436FE03AC0231153BE1EBB995EBDFBE07EFEF4EB2FC1759C6C9D6F85DDB9B1434FAEC6EE46EBF4D2F755B48184282FA191144AACB41789C427B1F04783C1477F38F401215CC4729CE031E39A26B07FC1D7A9E011A43A236C2162602A5FC72FE11ED5B92309A894443076AFBE08112F324523EF7A3E9BDCBACE8451827984C056AE4338179A68CCF2F2AB82504BC1D7618A0B843DED5240BB15610AF2EC2F2BF353373218998DF895630115654A8BE49580C3F3BC327EDBFD4DF575CBCA61EDAEB1C67A6776BDAFDFD87D840D10A908739D76B4CB2993C6B2515F7B185EE976E6743E9E953D31F046DEF0E2E2FCBD373C73A619D3998431874C4BE3F8902D198D7E87DD93F803F898678CD573C56CF15B6301971EA44841EADD23ACF21DDCC4AEE337FDFCB663E956F3B15BBBE1FA7CE43A77189C2C1994AD502B43A885842FC041120DF103D11A243718B02F66277A2BD60CBD8A68E6F9099BFC40C07E10EB6441DE0430CB64DE4275907E9F5B11357C707290025C6741B6B7C0D77A3376DF0FB17873BA85B858C9B3F9CA2932063A6999BD1868B2061E939E30A3C1C58793E2F45625F0ABF6EF0E05128E26144F394FAAEAEBD995F9065B7D60469050F23151790ECD9D5AEC10747BDE94EB54D958A6F26AC37828EF32C38A0B7D4B860569FA475833589034C5A2D658345F71424BA1D377E1EBD925B1187EA40E904C996D1909E788ACA1F5154363A6732A95C6E9204B624E6D1A271DB343E771A4D645C44EC9DB6C529D40E1629EDBE76F2F95DAE9B460AA6ACE718309D2C27EAF50E653A7D98EEFFE46238CC8031C35152C4BF8319EEBF3B6AC53F7B72BA7235886A8231CE28CDE1C4ACE69E451AE9E8E5431511DA95A3D1DA9A09A3A4EB1D64509FCD6C1B61BC8EF7450EB266AF764DF58B74DCAE8E578B7C638C847EA6585D499316BE23A589E671A9BF90A774A43E219032FFC934D19C5FD56060BC2E90A94B6973532B261FE86CCFAFF481E5FA9989DAA7BFE73C9414D595F1415AFBDDF6B2A23C667FDA32AC3023C4888A8D5F7BFFDB0E6E8873C4528B415097F2632DA10D9D524AFC36D0A9083A85682FC447DD1BDF64E540EFDC2C10E3636C152E07E6CAECB75F2BD2E3CDE282EBA6C13F8F55F6DC10C145D5710E6371C87C81C58055AD8DCF095284E013759CFA830691DD20234C1D62613A9E98A441A3F47A0D45E2B7E232C4393EB6409F10DBFCF749AE98952902C5943A0077E7FFCBD826AE61CDCA7E64DFD8C2D609AD44CE73DBFCA288BCBBCE7079AE90884699B9C37302BD4CA08B7DE954877829F0894976F0629F63EB2CE132429433075CF43F20C6FC90DC5F02DAC49B42B2E8DE3202F1F44B3ECC18C92B52489CA312A7FF34F846FFE8AF8F42F169537A9BC100000 , N'6.1.1-30610')

End;
GO
